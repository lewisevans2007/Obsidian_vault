#windows #malware 
![[Wannacry_message.png]]

WannaCry was a notorious ransomware attack that wreaked havoc worldwide in May 2017. It targeted [[Windows]] operating systems, encrypting data and demanding ransom payments in Bitcoin. This in-depth article will explore the origins, impact, and lessons learned from the WannaCry attack, highlighting the importance of cybersecurity and proactive measures in an increasingly connected world.

## Background
The WannaCry ransomware attack emerged on May 12, 2017, affecting hundreds of thousands of computers across 150 countries. It exploited a vulnerability known as [[EternalBlue]], which was initially developed by the United States National Security Agency (NSA) but later leaked by the hacking group called the Shadow Brokers. This vulnerability targeted the Windows Server Message Block (SMB) protocol, allowing the [[Ransomware]] to spread rapidly through networks.

## Propagation and Impact
WannaCry spread through various vectors, primarily via phishing emails and by leveraging the [[EternalBlue]] vulnerability. Once a system was infected, the ransomware encrypted files and displayed a ransom note demanding a payment in Bitcoin to unlock the files. The attack targeted both individuals and organizations, including hospitals, government agencies, and businesses, causing widespread disruption and financial losses.

## Technical Details
The WannaCry ransomware employed advanced encryption algorithms, including [[RSA]] and [[AES]], to encrypt files on infected systems. It utilized a worm-like capability to scan for vulnerable systems on the network and propagate rapidly, allowing it to infect numerous devices within a short period.

## Response and Mitigation
The WannaCry attack garnered significant attention from the cybersecurity community and led to a coordinated global response. Microsoft released emergency patches to address the EternalBlue vulnerability and encouraged users to update their systems promptly. Additionally, law enforcement agencies and security firms collaborated to investigate the attack and dismantle infrastructure supporting the ransomware.

## System changes
1. Initial Infection:
   - WannaCry primarily spread through phishing emails and by exploiting the [[EternalBlue]] vulnerability in the Windows SMB protocol.
   - Upon successful infection, WannaCry established a foothold on the compromised system.

2. Encryption:
   - WannaCry employed strong encryption algorithms, such as [[RSA]] and [[AES]], to encrypt files on the infected system.
   - It targeted a wide range of file types, including documents, images, videos, and more, rendering them inaccessible to the user.

3. File Renaming:
   - WannaCry renamed the encrypted files with a unique extension, often appending them with ".WCRY" or ".WNCRY".
   - This renaming process made it clear to the user which files were affected by the ransomware.

4. Ransom Note:
   - After completing the encryption process, WannaCry displayed a ransom note on the victim's screen.
   - The ransom note informed the user about the encryption and provided instructions on how to pay the ransom, typically in Bitcoin, to obtain the decryption key.

5. Network Propagation:
   - One of WannaCry's notable characteristics was its ability to spread rapidly across networks.
   - It employed a worm-like behavior, scanning the local network and exploiting the EternalBlue vulnerability to infect other vulnerable systems.

6. Kill Switch:
   - A unique feature of WannaCry was the presence of a "kill switch" domain.
   - Security researchers discovered that if the ransomware successfully connected to a specific domain, it would terminate its encryption routine.
   - This discovery enabled researchers to register the domain and effectively halt the spread of WannaCry to new systems.

7. System Compromise:
   - Beyond encrypting files, WannaCry could also impact system performance and stability due to its aggressive nature.
   - The ransomware consumed significant system resources, leading to slower performance, system crashes, and overall instability.